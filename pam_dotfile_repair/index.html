<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>pam_dotfile ä¿®ç†æ‰‹è®° | in /dev/null</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="pam_dotfile ä¿®ç†æ‰‹è®°æºèµ·ä¿®ç†è¿™ä¸ª pam_dotfile çš„èµ·å› æ˜¯@dotkrnl ã€‚ä»–è®¤ä¸ºç”¨ yubikey ä½œä¸ºç™»å½•çš„é‰´å®šçš„å……åˆ†å‡­æ®æ˜¯ä¸å½“çš„ã€‚å› ä¸º yubikey æ˜¯ç”±æ‰€æœ‰è€…æŒæœ‰çš„ï¼ˆWhat you have.ï¼‰ï¼Œå­˜åœ¨å¤±çªƒçš„é£é™©ï¼Œéœ€è¦å’Œæ‰€æœ‰è€…çŸ¥é“çš„ï¼ˆWhat you know.ï¼‰æ­é…æ¥ä½¿ç”¨ï¼Œæ‰ç§‘å­¦ã€‚ä½†æ˜¯äºŒè€…æ­é…èµ·æ¥ä½œé‰´å®šï¼Œå³åŒæ—¶é‰´å®š yubikey å’Œç³»ç»Ÿç™»å½•å¯†ç åˆæ˜¾å¾—å¾ˆéº»çƒ¦ï¼Œæ²¡æœ‰">
<meta property="og:type" content="article">
<meta property="og:title" content="pam_dotfile ä¿®ç†æ‰‹è®°">
<meta property="og:url" content="https://innull.com/pam_dotfile_repair/index.html">
<meta property="og:site_name" content="in /dev/null">
<meta property="og:description" content="pam_dotfile ä¿®ç†æ‰‹è®°æºèµ·ä¿®ç†è¿™ä¸ª pam_dotfile çš„èµ·å› æ˜¯@dotkrnl ã€‚ä»–è®¤ä¸ºç”¨ yubikey ä½œä¸ºç™»å½•çš„é‰´å®šçš„å……åˆ†å‡­æ®æ˜¯ä¸å½“çš„ã€‚å› ä¸º yubikey æ˜¯ç”±æ‰€æœ‰è€…æŒæœ‰çš„ï¼ˆWhat you have.ï¼‰ï¼Œå­˜åœ¨å¤±çªƒçš„é£é™©ï¼Œéœ€è¦å’Œæ‰€æœ‰è€…çŸ¥é“çš„ï¼ˆWhat you know.ï¼‰æ­é…æ¥ä½¿ç”¨ï¼Œæ‰ç§‘å­¦ã€‚ä½†æ˜¯äºŒè€…æ­é…èµ·æ¥ä½œé‰´å®šï¼Œå³åŒæ—¶é‰´å®š yubikey å’Œç³»ç»Ÿç™»å½•å¯†ç åˆæ˜¾å¾—å¾ˆéº»çƒ¦ï¼Œæ²¡æœ‰">
<meta property="og:updated_time" content="2016-02-13T14:44:50.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="pam_dotfile ä¿®ç†æ‰‹è®°">
<meta name="twitter:description" content="pam_dotfile ä¿®ç†æ‰‹è®°æºèµ·ä¿®ç†è¿™ä¸ª pam_dotfile çš„èµ·å› æ˜¯@dotkrnl ã€‚ä»–è®¤ä¸ºç”¨ yubikey ä½œä¸ºç™»å½•çš„é‰´å®šçš„å……åˆ†å‡­æ®æ˜¯ä¸å½“çš„ã€‚å› ä¸º yubikey æ˜¯ç”±æ‰€æœ‰è€…æŒæœ‰çš„ï¼ˆWhat you have.ï¼‰ï¼Œå­˜åœ¨å¤±çªƒçš„é£é™©ï¼Œéœ€è¦å’Œæ‰€æœ‰è€…çŸ¥é“çš„ï¼ˆWhat you know.ï¼‰æ­é…æ¥ä½¿ç”¨ï¼Œæ‰ç§‘å­¦ã€‚ä½†æ˜¯äºŒè€…æ­é…èµ·æ¥ä½œé‰´å®šï¼Œå³åŒæ—¶é‰´å®š yubikey å’Œç³»ç»Ÿç™»å½•å¯†ç åˆæ˜¾å¾—å¾ˆéº»çƒ¦ï¼Œæ²¡æœ‰">
  
    <link rel="alternate" href="/atom.xml" title="in /dev/null" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css" type="text/css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">in /dev/null</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="æœç´¢"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://innull.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-pam_dotfile_repair" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/pam_dotfile_repair/" class="article-date">
  <time datetime="2016-02-10T20:50:00.000Z" itemprop="datePublished">2016-02-11</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      pam_dotfile ä¿®ç†æ‰‹è®°
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="pam_dotfile__u4FEE_u7406_u624B_u8BB0"><a href="#pam_dotfile__u4FEE_u7406_u624B_u8BB0" class="headerlink" title="pam_dotfile ä¿®ç†æ‰‹è®°"></a><code>pam_dotfile</code> ä¿®ç†æ‰‹è®°</h2><h3 id="u6E90_u8D77"><a href="#u6E90_u8D77" class="headerlink" title="æºèµ·"></a>æºèµ·</h3><p>ä¿®ç†è¿™ä¸ª <code>pam_dotfile</code> çš„èµ·å› æ˜¯<a href="http://www.dotkrnl.com" target="_blank" rel="external">@dotkrnl</a> ã€‚ä»–è®¤ä¸ºç”¨ yubikey ä½œä¸ºç™»å½•çš„é‰´å®šçš„å……åˆ†å‡­æ®æ˜¯ä¸å½“çš„ã€‚å› ä¸º yubikey æ˜¯ç”±æ‰€æœ‰è€…æŒæœ‰çš„ï¼ˆWhat you have.ï¼‰ï¼Œå­˜åœ¨å¤±çªƒçš„é£é™©ï¼Œéœ€è¦å’Œæ‰€æœ‰è€…çŸ¥é“çš„ï¼ˆWhat you know.ï¼‰æ­é…æ¥ä½¿ç”¨ï¼Œæ‰ç§‘å­¦ã€‚ä½†æ˜¯äºŒè€…æ­é…èµ·æ¥ä½œé‰´å®šï¼Œå³åŒæ—¶é‰´å®š yubikey å’Œç³»ç»Ÿç™»å½•å¯†ç åˆæ˜¾å¾—å¾ˆéº»çƒ¦ï¼Œæ²¡æœ‰ä½“ç°å‡º yubikey çš„æ–¹ä¾¿ä¹‹å¤„ã€‚äºæ˜¯ä¸€ä¸ªè¿™æ ·çš„è®¾æƒ³è¢«æå‡ºæ¥ï¼Œæ‰å¼•å‘äº†ä¸‹é¢ä¸€è¿ä¸²çš„è¡€æ¡ˆã€‚</p>
<a id="more"></a>
<pre><code>bigeag1e 11:57:32    YubiKey 4 ç®€ä»‹ä¸é…ç½® | K.I.S.S
                     https://bigeagle.me/2016/02/yubikey-4/
dotkrnl  12:02:10       auth sufficient
dotkrnl  12:02:41       çœ‹èµ·æ¥å°±å¾ˆä¸å®‰å…¨  
shankerwangmiao  12:25:54     æ€ä¹ˆä¸å®‰å…¨äº†ï¼Ÿ
dotkrnl  12:26:32 YubiKey ä¸€æ’è¿›å»å°±å¯ä»¥ç™»å½•ç”¨æˆ·ï¼Œä¸¢å¤±æƒé™å°±ç›´æ¥è¢«è·å¾—äº†å•Š
dotkrnl  12:26:41     æ²¡æœ‰ç¬¬äºŒæ­¥å¯†ç 
shankerwangmiao    12:27:11     å¯†ç è¿˜æ˜¯å°‘ç”¨ä¸ºå¦™
shankerwangmiao    12:28:00     ä½ yubikeyè¿˜èƒ½å’Œç”µè„‘ä¸€èµ·ä¸¢äº†å•Šï¼Ÿ
bigeag1e 12:28:25 ä½ å¯ä»¥æ”¹æˆ auth required å•Š
dotkrnl  12:28:44     æˆ‘è§‰å¾— required æ¯”è¾ƒé è°±å‘¢
bigeag1e 12:29:03 è¿˜æ˜¯TOTPï¼ŒU2Få’ŒTOTPæœ‰å…¶ä¸€å³å¯
dotkrnl  12:29:09     å­˜åœ¨è¿™ç§å¯èƒ½å•Šï¼Œæ‰€ä»¥æˆ‘è§‰å¾—æ¯”å¯†ç å±é™©
shankerwangmiao    12:29:19     å†è¯´äº†ï¼Œç”µè„‘ä¸¢äº†ï¼Œæœ‰å¤šå°‘å¯†ç ä¹ŸæŒ¡ä¸ä½å•Š
dotkrnl  12:29:46     å…¨ç›˜åŠ å¯† ğŸ¶
dotkrnl  12:29:48     
shankerwangmiao    12:30:01     é‚£è¦yubikey
dotkrnl  12:30:19     è§£é”å•Š
dotkrnl  12:30:30     ä½ ä¹Ÿä¸ä¼šå…³æœºçš„å§ ğŸ¶
shankerwangmiao    12:31:35     ä½•ç”¨ï¼Ÿ
shankerwangmiao    12:31:41     é¢
shankerwangmiao    12:31:58     åæ­£æˆ‘è§£é”ç”µè„‘æ˜¯sufficient
shankerwangmiao    12:32:35     loginæ˜¯required
dotkrnl  12:32:39     æˆ‘çš„æœŸæœ›æ˜¯èƒ½ 1ã€è¾“å®Œæ•´å¯†ç  2ã€æ’ key åŒæ—¶è¾“ä¸€ä¸ªå¼±å¯†ç ã€‚äºŒé€‰ä¸€ã€‚ä½†æ˜¯ä¸çŸ¥é“æ€ä¹ˆåšã€‚
shankerwangmiao    12:33:12     ä½ éœ€è¦é…ç½®ä¸€ä¸ªpam
shankerwangmiao    12:34:09     è¿™ä¸ªpamä»…ä»…éªŒè¯è¾“å…¥çš„å¯†ç æ˜¯ä¸æ˜¯123456
shankerwangmiao    12:34:09     ç„¶ååœ¨pamé‡Œé…ç½®ä¸‰ä¸ªè§„åˆ™
shankerwangmiao    12:36:29     ç¬¬ä¸€æ¡yubikeyçš„ï¼ŒæˆåŠŸç»§ç»­å¾€ä¸‹èµ°ï¼Œå¤±è´¥åˆ™è·³è¿‡ä¸‹é¢çš„ä¸€æ¡
shankerwangmiao    12:36:29     ç¬¬äºŒæ¡æ˜¯å¼±å£ä»¤çš„ï¼Œæ˜¯sufficient
shankerwangmiao    12:36:29     ç¬¬ä¸‰æ¡æ˜¯ç³»ç»ŸåŸæ¥çš„
dotkrnl  12:42:12     è¿™ä¸ªæ€ä¹ˆåš
shankerwangmiao    12:44:08     å°±æ˜¯åœ¨åŸæ¥sufficientçš„ä½ç½®å¤„å¡«ä¸€ä¸ªè¡¨è¾¾å¼
shankerwangmiao    12:44:20     è¿™ä¸ªè¡¨è¾¾å¼åœ¨pam.confçš„mané‡Œæœ‰è®²è§£
</code></pre><p>å½“æ—¶æå‡ºè¿™ä¸ªé…ç½® pam çš„æ–¹æ³•ï¼Œæ˜¯å› ä¸ºåˆšåˆšçœ‹è¿‡ linux pam çš„ man é¡µé¢ï¼Œæ‰çŸ¥é“ linux pam çš„ conf è¿˜å¯ä»¥è¿™æ ·å†™ï¼š</p>
<pre><code>For the more complicated syntax valid control values have the following
form:

          [value1=action1 value2=action2 ...]

Where valueN corresponds to the return code from the function invoked
in the module for which the line is defined. It is selected from one of
these: success, open_err, symbol_err, service_err, system_err, buf_err,
perm_denied, auth_err, cred_insufficient, authinfo_unavail,
user_unknown, maxtries, new_authtok_reqd, acct_expired, session_err,
cred_unavail, cred_expired, cred_err, no_module_data, conv_err,
authtok_err, authtok_recover_err, authtok_lock_busy,
authtok_disable_aging, try_again, ignore, abort, authtok_expired,
module_unknown, bad_item, conv_again, incomplete, and default.

The last of these, default, implies &apos;all valueN&apos;s not mentioned
explicitly. Note, the full list of PAM errors is available in
/usr/include/security/_pam_types.h. The actionN can take one of the
following forms:

ignore
    when used with a stack of modules, the module&apos;s return status will
    not contribute to the return code the application obtains.

bad
    this action indicates that the return code should be thought of as
    indicative of the module failing. If this module is the first in
    the stack to fail, its status value will be used for that of the
    whole stack.

die
    equivalent to bad with the side effect of terminating the module
    stack and PAM immediately returning to the application.

ok
    this tells PAM that the administrator thinks this return code
    should contribute directly to the return code of the full stack of
    modules. In other words, if the former state of the stack would
    lead to a return of PAM_SUCCESS, the module&apos;s return code will
    override this value. Note, if the former state of the stack holds
    some value that is indicative of a modules failure, this &apos;ok&apos; value
    will not be used to override that value.

done
    equivalent to ok with the side effect of terminating the module
    stack and PAM immediately returning to the application.

N (an unsigned integer)
    equivalent to ok with the side effect of jumping over the next N
    modules in the stack. Note that N equal to 0 is not allowed (and it
    would be identical to ok in such case).

reset
    clear all memory of the state of the module stack and start again
    with the next stacked module.

Each of the four keywords: required; requisite; sufficient; and
optional, have an equivalent expression in terms of the [...] syntax.
They are as follows:
required
    [success=ok new_authtok_reqd=ok ignore=ignore default=bad]

requisite
    [success=ok new_authtok_reqd=ok ignore=ignore default=die]

sufficient
    [success=done new_authtok_reqd=done default=ignore]

optional
    [success=ok new_authtok_reqd=ok default=ignore]
</code></pre><p>æˆ‘æ¥æ¦‚æ‹¬ä¸€ä¸‹ä¸Šé¢çš„è¯´æ˜çš„æ„æ€ï¼šé™¤äº†å¯ä»¥é…ç½®ä¸º <code>required</code>ã€<code>sufficient</code> ä¹‹ç±»çš„ä»¥å¤–ï¼Œè¿˜å¯ä»¥é’ˆå¯¹æ¯ä¸ªé‰´å®šæ¨¡å—çš„ä¸åŒé‰´å®šç»“è®ºä½œå‡ºä¸åŒçš„åŠ¨ä½œï¼ŒåŒ…æ‹¬å¿½ç•¥é‰´å®šç»“è®ºï¼Œé‰´å®šå¤±è´¥ï¼Œé‰´å®šå¤±è´¥å¹¶é€€å‡ºï¼Œç»§ç»­é‰´å®šï¼Œé‰´å®šæˆåŠŸå¹¶é€€å‡ºã€é‡ç½®é‰´å®šç»“è®ºå’Œ<em>è·³è¿‡ä¸€äº›é‰´å®šæ¨¡å—</em>ï¼ˆè¿™é‡Œçš„æ¦‚æ‹¬ç¨å¾®æœ‰äº›ä¸å‡†ç¡®ï¼Œå®é™…çš„åŠ¨ä½œçš„å«ä¹‰è¦æ›´å¤æ‚ä¸€äº›ï¼Œæˆ‘ä¹‹åä¼šå•ç‹¬ä»‹ç»ï¼‰ã€‚</p>
<p>äºæ˜¯å¾ˆè‡ªç„¶çš„ï¼Œä¸ºäº†å®ç°â€œ1ã€è¾“å®Œæ•´å¯†ç  2ã€æ’ key åŒæ—¶è¾“ä¸€ä¸ªå¼±å¯†ç â€éƒ½å¯ä»¥å®Œæˆé‰´å®šçš„åŠŸèƒ½ï¼Œæˆ‘ä»¬å¯ä»¥é‡‡å–è¿™æ ·çš„æ–¹æ³•ï¼š</p>
<pre><code>    fail    +-------------+
/-----------| pam_yubikey |
|           +-------------+
|                   |
|                   | success
|                  \|/
|           +-------------+   success   +----------+
|           | pam_å¼±å£ä»¤   | -----------&gt;|  é‰´å®šæˆåŠŸ |
|           +-------------+             +----------+
|                   |                      /|\
|                   | fail                  |
|                  \|/                      |
|           +-------------+    success      |
\--------&gt;  | pam_å¼ºå£ä»¤   | ----------------/
            +-------------+
                    |
                    | fail
                   \|/
            +-------------+
            | é‰´å®šå¤±è´¥     |
            +-------------+
</code></pre><p>ä¸éš¾æƒ³åˆ°ï¼Œè¿™ä¸ªé‰´å®šæµç¨‹å¾ˆå®¹æ˜“ç”¨ linux pam çš„â€œè·³è¿‡é‰´å®šæ¨¡å—â€çš„åŠŸèƒ½æ¥å®ç°ã€‚å…¶ä¸­â€œ<code>pam_å¼ºå£ä»¤</code>â€å¯ä»¥ç”¨ç³»ç»ŸåŸå…ˆçš„ pam æ¨¡å—ï¼Œå”¯ä¸€ç¼ºçš„å°±æ˜¯ â€œ<code>pam_å¼±å£ä»¤</code>â€ã€‚ä¸è¿‡è¿™ä¸ªè‡ªå·±å†™ä¹Ÿä¸ä¼šå¾ˆéš¾ï¼Œç…§ç€åˆ«çš„ pam æ¨¡å—çš„ä»£ç æ”¹ä¸€æ”¹åº”è¯¥å°±èƒ½æˆã€‚</p>
<p>è¿™å°±æ˜¯æˆ‘åœ¨ä¸Šé¢çš„èŠå¤©é‡Œä½œå‡ºå›å¤çš„æ€ç»´è¿‡ç¨‹ï¼Œå½“æ—¶å› ä¸ºåœ¨å¤–è¾¹èµ°è·¯ï¼Œæ„Ÿè§‰è¿™æ ·å¯ä»¥å®ç°ï¼Œäºæ˜¯å°±è¿™ä¹ˆå›ç­”äº† <a href="http://www.dotkrnl.com" target="_blank" rel="external">@dotkrnl</a>ã€‚</p>
<h3 id="u53D1_u5C55"><a href="#u53D1_u5C55" class="headerlink" title="å‘å±•"></a>å‘å±•</h3><p>æœ‰ä¸€å¥åè¨€æ˜¯è¿™ä¹ˆè¯´çš„ï¼š</p>
<blockquote>
<p>Talk is cheap, show me the f**k code.</p>
</blockquote>
<p>æ›´ä½•å†µæˆ‘ä¹Ÿè®¤ä¸ºè¿™æ ·ä½¿ç”¨ yubikey æ¯”è¾ƒ make senceï¼Œæ‰€ä»¥å°±ç€æ‰‹å®ç°ä¸Šè¾¹çš„æ€è·¯ã€‚é¦–å…ˆæˆ‘è¦ç¡®è®¤çš„æ˜¯ï¼Œpam.conf èƒ½ä¸èƒ½åƒæˆ‘æƒ³çš„é‚£æ ·å†™â€”â€”æ¯•ç«Ÿï¼Œæ”¹é…ç½®æ–‡ä»¶æ¯”å†™ä»£ç å®¹æ˜“å¤šäº†ã€‚æµ‹è¯•é…ç½®æ–‡ä»¶å†™æ³•çš„æ—¶å€™å¯ä»¥å…ˆç”¨ <code>pam_permit</code> å’Œ <code>pam_deny</code> ä»£æ›¿æ²¡æœ‰å®ç°çš„é‚£ä¸ª <code>pam_å¼±å£ä»¤</code>ã€‚</p>
<p>è¯´å¹²å°±å¹²ï¼Œä¸ºäº†æµ‹è¯• pam çš„é…ç½®ï¼Œè‚¯å®šä¸èƒ½æ‹¿æˆ‘çš„ login å’Œ sudo å¼€åˆ€ï¼Œå¦åˆ™è‚¯å®šæ˜¯ä½œæ­»çš„èŠ‚å¥ã€‚æµ‹è¯• pam çš„é…ç½®çš„ç¨‹åºåŸåˆ™ä¸Šä¹Ÿå¯ä»¥è‡ªå·±å†™ï¼Œä¸è¿‡è¿™ç§è½®å­è‚¯å®šæœ‰äººé€ è¿‡ã€‚äºæ˜¯æ‰“å¼€ä¸‡èƒ½çš„<del>åº¦å¨˜</del> Google ï¼Œæ‹¿â€œtest pam configurationâ€æœç´¢ä¸€ä¸‹ï¼Œæ‰¾åˆ°ä¸€ç¯‡ ubuntu çš„ manualï¼Œè®²çš„æ˜¯ pamtest è¿™ä¸ªå·¥å…·ï¼Œåˆšå¥½æ˜¯æˆ‘éœ€è¦çš„ã€‚</p>
<p>ç”±äºæˆ‘å’Œ <a href="http://www.dotkrnl.com" target="_blank" rel="external">@dotkrnl</a> éƒ½æ˜¯å°† OS X ä½œä¸ºæ—¥å¸¸ä½¿ç”¨çš„ç³»ç»Ÿï¼Œå› æ­¤ï¼Œè¦æ‰¾åˆ°è¿™ä¸ªç¨‹åºçš„æºä»£ç ã€‚è¿™ä¸ªç¨‹åºæ˜¯ç”±ä¸€ä¸ªå«åš <code>libpam-dotfile</code> çš„åŒ…æä¾›çš„ã€‚ç­‰ä¸€ä¸‹ï¼Œè¿™ä¸ªåŒ…çš„åå­—ä¼¼ä¹è¯´æ˜ï¼Œè¿™ä¸ªåŒ…ä¸»è¦çš„åŠŸèƒ½åº”è¯¥æ˜¯ä¸€ä¸ª pam çš„æ¨¡å—ã€‚äºæ˜¯ç›´æ¥å‰å¾€ man é¡µé¢ä¸­å£°ç§°çš„<a href="http://0pointer.de/lennart/projects/pam_dotfile/" target="_blank" rel="external">é¡¹ç›®é¡µé¢</a>ã€‚</p>
<p>ç®€å•çš„æµè§ˆäº†ä¸€ä¸‹è¿™ä¸ª pam æ¨¡å—çš„åŠŸèƒ½ã€‚è¿™ä¸ª pam æ¨¡å—çš„ä¸­å¿ƒæ€æƒ³æ˜¯ï¼Œåœ¨ä¸€ä¸ªç”¨æˆ·çš„ <code>home</code> ç›®å½•ä¸‹åˆ›å»ºè‹¥å¹² secret æ–‡ä»¶ï¼Œç”¨äºå­˜å‚¨ä¸åŒçš„ pam service æ‰€ä½¿ç”¨çš„å¯†ç çš„æ•£åˆ—å€¼ã€‚åœ¨é‰´å®šçš„æ—¶å€™æ ¹æ®é‰´å®šçš„ pam serviceï¼Œè¯»å–ç›¸åº”çš„æ•£åˆ—å€¼ï¼Œç”¨äºé‰´å®šç”¨æˆ·æä¾›çš„ä½œä¸ºé‰´å®šå‡­æ®çš„å¯†ç ã€‚è¿™æ­£æ˜¯æˆ‘ä»¬éœ€è¦çš„ <code>pam_å¼±å£ä»¤</code> ã€‚çœŸæ˜¯è¸ç ´é“é‹æ— è§…å¤„ï¼Œå¾—æ¥å…¨ä¸è´¹å·¥å¤«ï¼Œæ—¢ç„¶å·²ç»æœ‰äººå¸®æˆ‘ä»¬é€ å¥½äº†è½®å­ï¼Œæˆ‘ä»¬ä¸ºå•¥ä¸ç”¨å‘¢ï¼Ÿäºæ˜¯èµ¶ç´§æ‰¾ä¸‹è½½åœ°å€ï¼‹æºç ä»“åº“ã€‚ç»“æœæ— æ„ä¸­çŸåˆ°äº† â€œRequirementsâ€ ä¸€èŠ‚ï¼Œé‡Œé¢èµ«ç„¶å†™ç€ï¼š</p>
<blockquote>
<p><code>pam_dotfile</code> was developed and tested on Debian GNU/Linux â€œtestingâ€ from July <strong>2003</strong>, it should work on most other Linux distributions</p>
</blockquote>
<p>å½“æ—¶å¿ƒä¸­é£˜è¿‡ä¸€é˜µè‰æ³¥é©¬ã€‚ä½†æ˜¯æœ¬ç€â€œå®å¯ä¿®è€è½®å­ä¹Ÿä¸é€ è½®å­â€çš„æ€æƒ³ï¼Œæˆ‘è¿˜æ˜¯æŠŠæºä»£ç ä¸‹è½½äº†ä¸‹æ¥ï¼Œå¿ƒæƒ³ï¼Œpam çš„æ¥å£ä¸€ç›´æ²¡æ€ä¹ˆå˜è¿‡ï¼Œè¯´ä¸å®šè¿˜èƒ½ç”¨ã€‚ç„¶è€Œï¼Œè¿™æ—¶æˆ‘ç«‹äº†ä¸€ä¸ªå“å½“å½“çš„ flagã€‚</p>
<h3 id="u9AD8_u6F6E"><a href="#u9AD8_u6F6E" class="headerlink" title="é«˜æ½®"></a>é«˜æ½®</h3><p>æˆ‘æŠŠæºä»£ç ä¸‹è½½ä¸‹æ¥ï¼Œå¼€å§‹æ‰§è¡Œ <code>./configure</code>ã€‚ç«Ÿç„¶æ²¡æŠ¥é”™ï¼çœ‹æ¥æœ‰æˆã€‚ç»§ç»­ <code>make</code>ï¼Œå¦¥å¦¥çš„æŠ¥é”™äº†ã€‚</p>
<p>æç¤ºæ˜¯ç¼ºå¤´æ–‡ä»¶ï¼Œå°¼ç›ã€‚ã€‚ã€‚ã€‚ç¼ºå¤´æ–‡ä»¶ä½  <code>configure</code> çš„æ—¶å€™ä¸è¯´ï¼Œé‚£ä½  <code>configure</code> åœ¨å¹²äº›å•¥ï¼Ÿ</p>
<p>äºæ˜¯æœæ–­åœ¨ <del>gay</del>github ä¸Š clone ä¸€ä»½è¿™ä¸ªä»£ç ï¼Œç„¶åæ“åˆ€å¼€å§‹æ”¹ã€‚è¿™æ—¶æˆ‘çªç„¶æƒ³èµ·æˆ‘ä¸å¤ªä¼šç”¨ autotools å•Šã€‚æœ¬ç€â€œæ²¡åƒçŒªè‚‰ä½†æ˜¯è§è¿‡çŒªè·‘â€çš„ç²¾ç¥ï¼Œé‰´äºæˆ‘ç¼–è¯‘è¿‡è¿™ä¹ˆå¤šé gcc ï¼Œautotools çš„å¤§è‡´æ€æƒ³è¿˜æ˜¯èƒ½ææ‡‚çš„ã€‚ç„¶åæˆ‘å°±åŒæ­¥åœ°æ‰“å¼€ <code>pam_yubico</code> çš„ä»£ç ï¼Œç…§ç€è¾¹å­¦ä¹ è¾¹æ”¹ã€‚</p>
<p>æ•´ä¸ªé¡¹ç›®åˆ†è¿™ä¹ˆå‡ ä¸ªéƒ¨åˆ†ï¼š</p>
<ul>
<li><code>pam_dotfile</code> è¿™ä¸ªæ˜¯ä¸€ä¸ª shared libraryï¼Œå°±æ˜¯æˆ‘ä»¬è¦ç”¨çš„ pam æ¨¡å—ã€‚</li>
<li><code>pam-dotfile-helper</code> è¿™ä¸ªæ˜¯ä¸€ä¸ª setuid çš„ helper ç¨‹åºï¼Œå½“ pam æ¨¡å—çš„æ‰§è¡Œæƒé™ä¸è¶³ä»¥è¯»å–äº‹å…ˆä¿å­˜çš„ secret æ–‡ä»¶æ—¶ï¼Œä½¿ç”¨è¿™ä¸ª helper ç¨‹åºæå‡æƒé™ï¼Œå°†é‰´å®šå·¥ä½œå§”æ‰˜ç»™è¿™ä¸ªç¨‹åºã€‚</li>
<li><code>pam-dotfile-gen</code> è¿™ä¸ªæ˜¯ä¸€ä¸ªç”¨äºç”Ÿæˆ secret æ–‡ä»¶çš„ç¨‹åºã€‚</li>
<li><code>pamtest</code> è¿™ä¸ªç”¨äºæµ‹è¯• pam çš„å·¥ä½œæƒ…å†µã€‚</li>
</ul>
<p>ä¿®æ”¹çš„ç»†èŠ‚æˆ‘å°±ä¸ä¸€ä¸€å™è¿°äº†ã€‚å®é™…ä¸Šä½œçš„æ”¹åŠ¨ä¸»è¦æ˜¯é€‚é…ä¸åŒçš„ pam åº“çš„å¤´æ–‡ä»¶çš„åŒºåˆ«ã€‚OS X ä½¿ç”¨çš„ pam åº“æ˜¯ <code>OpenPAM</code>ï¼Œè€Œ linux ä¸Šçš„ pam åº“æ˜¯ <code>Linux PAM</code>ï¼Œå› æ­¤å¤´æ–‡ä»¶çš„åå­—å’Œå­˜æ”¾ä½ç½®éœ€è¦è¿›è¡Œé€‚é…ã€‚åªéœ€è¦ä¸€ä¸€æ¢æµ‹å°±å¥½ã€‚æ”¹åŠ¨çš„è¦ç‚¹å¦‚ä¸‹ï¼š</p>
<ul>
<li><p>åœ¨æ‰€æœ‰çš„ .c æ–‡ä»¶é‡ŒåŒ…å« <code>config.h</code>ï¼Œåœ¨æ‰€æœ‰çš„åŒ…å«çš„å¤´æ–‡ä»¶çš„ä¸¤ä¾§åŠ ä¸Š <code>#ifdef HAVE_XXX_H</code> å’Œ <code>#endif</code> ï¼ˆæˆ‘å¾ˆè¯§å¼‚ä¸ºå•¥åŸä½œè€…ä½¿ç”¨äº† autotoolsï¼Œç”Ÿæˆäº† <code>config.h</code> å´æ²¡åŒ…å«ï¼‰</p>
</li>
<li><p>æ·»åŠ å¯¹ <code>security/pam_appl.h</code>, <code>security/pam_modules.h</code>, <code>security/_pam_macros.h</code>,  <code>security/pam_modutil.h</code> çš„ä¾¦æµ‹</p>
</li>
<li>æ·»åŠ å¯¹ <code>security/pam_appl.h</code> çš„åŒ…å«</li>
</ul>
<p>ä¹‹åå†ç¼–è¯‘ï¼Œä¼¼ä¹å°±å¯ä»¥é€šè¿‡äº†ã€‚ä¸€é˜µè¾“å‡ºä¹‹åï¼Œçªç„¶ç¼–è¯‘åœäº†ä¸‹æ¥ï¼Œæç¤ºè¿™ä¸ªé”™è¯¯ï¼š</p>
<pre><code>pamtest.c: åœ¨å‡½æ•°â€˜mainâ€™ä¸­:
pamtest.c:42:35: é”™è¯¯ï¼šâ€˜misc_convâ€™æœªå£°æ˜(åœ¨æ­¤å‡½æ•°å†…ç¬¬ä¸€æ¬¡ä½¿ç”¨)
     static struct pam_conv pc = { misc_conv, NULL };
                                   ^
</code></pre><p>è¿™ä¸ª <code>misc_conv</code> æ˜¯ä¸ªå•¥ä¸œè¥¿ï¼Ÿé€šè¿‡è§‚å¯Ÿ <code>struct pam_conv</code> çš„å®šä¹‰ï¼š</p>
<pre><code>struct pam_conv {
        int     (*conv)(int, const struct pam_message **,
            struct pam_response **, void *);
        void    *appdata_ptr;
};
</code></pre><p>å¯çŸ¥ï¼Œ<code>misc_conv</code> åº”è¯¥æ˜¯ä¸ªå‡½æ•°ï¼Œé”™è¯¯åº”è¯¥æ˜¯ç”±äºå°‘åŒ…å«äº†å¤´æ–‡ä»¶å¯¼è‡´çš„ã€‚äºæ˜¯ç«‹åˆ»æŸ¥æ‰¾è¿™ä¸ªå‡½æ•°çš„å¤´æ–‡ä»¶ï¼ŒGoogle å‘Šè¯‰æˆ‘ï¼Œè¿™ä¸ªå‡½æ•°åœ¨ <code>security/pam_misc.h</code>ã€‚ç«‹åˆ»æ£€æµ‹å¹¶åŒ…å«ä¹‹ã€‚ä¸”æ…¢ï¼æˆ‘çš„ç³»ç»Ÿä¸Šå¹¶æ²¡æœ‰è¿™ä¸ªå¤´æ–‡ä»¶å•Šï¼Ÿè¿™ä¸‹å‘çˆ¹äº†ã€‚äºæ˜¯ç”¨ misc_conv+ OSX åœ¨ Google ä¸Šæœç´¢ï¼Œå¹¶æ²¡æœ‰å•¥ç»“è®ºã€‚äºæ˜¯è¿”å›çœ‹ linux ä¸‹å…³äºè¿™ä¸ªå‡½æ•°çš„ manualï¼Œå…¶ä¸­æåˆ°ï¼š</p>
<blockquote>
<p>The <code>misc_conv</code> function is part of <code>libpam_misc</code> and not of the standard <code>libpam</code> library.</p>
</blockquote>
<p>äºæ˜¯è½¬è€ŒæŸ¥æ‰¾ <code>pam_misc</code> è¿™ä¸ª library åœ¨ OSX ä¸Šçš„æ›¿ç”¨å“ï¼Œç»“æœä¹Ÿæ²¡æ‰¾åˆ°ä»€ä¹ˆç»“è®ºã€‚äºæ˜¯ç»§ç»­çœ‹è¿™ä¸ªå‡½æ•°å¹²ä»€ä¹ˆç”¨çš„ã€‚</p>
<blockquote>
<p>  This function will prompt the user with the appropriate comments and obtain the appropriate inputs as directed by authentication modules.</p>
</blockquote>
<p>å””ï¼ŒåŸæ¥æ˜¯ç”¨æ¥è¾“å…¥å¯†ç çš„å‘€ã€‚OS X ä¸Šæ˜¾ç„¶åº”è¯¥æœ‰ç›¸åº”çš„å‡½æ•°å•Šã€‚è¿™ç§å‡½æ•°ä¼šåœ¨å“ªå‡ºç°å‘¢ï¼Ÿäºæ˜¯æˆ‘å±•å¼€äº†è”æƒ³ã€‚</p>
<p>å‡ ä¹ä¸å‡ºä¸¤ç§’é’Ÿï¼Œæˆ‘å°±å¾—åˆ°äº†ç­”æ¡ˆï¼š<code>su</code> å’Œ <code>sudo</code>ï¼Œåªè¦ç¿»ä¸€ä¸‹ OS X ä¸Šçš„è¿™ä¸¤ä¸ªç¨‹åºçš„ä»£ç å°±å¯ä»¥çŸ¥é“äº†ã€‚äºæ˜¯æˆ‘ç«‹åˆ»æ‰¾åˆ°äº† <code>su</code> çš„<a href="http://www.opensource.apple.com/source/shell_cmds/shell_cmds-162/su/su.c" target="_blank" rel="external">æºä»£ç </a>ï¼ˆå› ä¸º <code>su</code> æ¯” <code>sudo</code> ç®€å•ï¼‰ï¼Œæ˜ å…¥çœ¼å¸˜çš„å°±æ˜¯ï¼š</p>
<pre><code>int
main(int argc, char *argv[])
{
    static char    *cleanenv;
    struct passwd    *pwd;
    struct pam_conv    conv = { openpam_ttyconv, NULL };
    enum tristate    iscsh;
</code></pre><p>å“ˆå“ˆï¼ŒåŸæ¥æ˜¯<code>openpam_ttyconv</code>ï¼Œæœç´¢ä¹‹ï¼Œå¾—åˆ° <code>security/openpam.h</code>ã€‚</p>
<p>ç„¶åå°±æ˜¯å¦‚ä½•åœ¨ä¸¤ä¸ªå‡½æ•°ä¸­é€‰æ‹©äº†ï¼Œè¿™é‡Œæˆ‘å‚è€ƒäº†<a href="https://github.com/TinLe/macports/blob/082d31e48a3498fde4cfe0c479983128a479a791/net/quagga/files/quagga-patch2.diff" target="_blank" rel="external">è¿™é‡Œ</a> çš„ä»£ç ï¼š</p>
<pre><code>AC_CHECK_HEADER([pam/pam_misc.h],
  [AC_DEFINE(HAVE_PAM_MISC_H,,Have pam_misc.h)
   AC_DEFINE(PAM_CONV_FUNC,misc_conv,Have misc_conv)
   pam_conv_func=&quot;misc_conv&quot;
  ],
  [], QUAGGA_INCLUDES)
 AC_CHECK_HEADER([security/openpam.h],
   [AC_DEFINE(HAVE_OPENPAM_H,,Have openpam.h)
    AC_DEFINE(PAM_CONV_FUNC,openpam_ttyconv,Have openpam_ttyconv)
</code></pre><p>å¤§æ¦‚çš„å®ç°æ–¹å¼å°±æ˜¯åœ¨ <code>configure</code> çš„æ—¶å€™æ¢æµ‹ <code>pam/pam_misc.h</code> å’Œ <code>security/openpam.h</code>ï¼Œå¹¶å®šä¹‰å® <code>PAM_CONV_FUNC</code> ä¸ºç›¸åº”çš„å‡½æ•°åï¼Œç„¶ååœ¨ä»£ç ä¸­ç›´æ¥ä½¿ç”¨ï¼š</p>
<pre><code>static struct pam_conv pc = { PAM_CONV_FUNC, NULL };
</code></pre><p>OKï¼Œæœ€åä¿®å¤äº†è¿™ä¸ªä½ç½®ï¼Œç„¶åç¼–è¯‘å°±é€šè¿‡äº†ã€‚</p>
<h3 id="u5C3E_u58F0"><a href="#u5C3E_u58F0" class="headerlink" title="å°¾å£°"></a>å°¾å£°</h3><p>ç¼–è¯‘é€šè¿‡äº†å°±è¦ç®€å•çš„æµ‹è¯•ä¸€ä¸‹ä»£ç è¿˜èƒ½å¦ workã€‚äºæ˜¯å…ˆæ‰§è¡Œ</p>
<pre><code>$ pam-dotfile-gen -a test
</code></pre><p>ç„¶åè¾“å…¥ä¸€ä¸ªç®€å•çš„å¯†ç  <code>12345</code>ï¼Œäºæ˜¯å°±ç”Ÿæˆäº† <code>~/.pam-test</code>ï¼Œç„¶åå†™ä¸€ä¸ª <code>/etc/pam.d/test</code></p>
<pre><code>auth       required       /usr/local/lib/security/pam_dotfile.so try_first_pass
</code></pre><p>æœ€åæ‰§è¡Œï¼š</p>
<pre><code>$ pamtest test $USER
</code></pre><p>å…ˆè¾“å…¥ä¸€ä¸ªé”™è¯¯çš„å¯†ç ï¼Œå†è¾“å…¥ä¸€ä¸ªæ­£ç¡®çš„å¯†ç ï¼Œäºæ˜¯å¯ä»¥çœ‹å‡ºï¼Œè¿™ä¸ªæ¨¡å—åœ¨è¿™ä¸ªç»™å®šçš„è¾“å…¥ä¸‹æ˜¯å¯ä»¥å·¥ä½œçš„ã€‚é‰´äºè¿™ä»½ä»£ç å·²ç»æ˜¯æˆå‹çš„ä»£ç ï¼Œæˆ‘å¹¶æ²¡æœ‰æ”¹åŠ¨ä»€ä¹ˆé€»è¾‘çš„éƒ¨åˆ†ï¼Œäºæ˜¯å¯ä»¥æ¨å®šè¿™ä»½ä»£ç åº”è¯¥æ˜¯æ²¡ä»€ä¹ˆé—®é¢˜äº†ã€‚</p>
<p>äºæ˜¯æœ¬æ¥æˆ‘ä»¬æ˜¯æƒ³å…ˆè§£å†³ <code>pam.conf</code> çš„é—®é¢˜ï¼Œç»“æœä¸å°å¿ƒè§£å†³äº† <code>pam_å¼±å£ä»¤</code> çš„é—®é¢˜ã€‚æ­¤æ—¶æˆ‘ä»¬æœ‰äº† <code>pamtest</code> äºæ˜¯å°±å¯ä»¥é¡ºåˆ©åœ°æµ‹è¯•æˆ‘ä»¬æœŸæœ›çš„é‚£ä¸ªé…ç½®æ–‡ä»¶äº†ï¼š</p>
<pre><code>auth       [success=ok ignore=ignore default=1]       pam_yubico.so mode=challenge-response
auth       sufficient     /usr/local/lib/security/pam_dotfile.so try_first_pass
auth       required       pam_opendirectory.so try_first_pass  # è¿™ä¸ªæ˜¯ OS X ä¸ŠåŸæœ‰çš„ pam æ¨¡å—ï¼Œç”¨äºæ ‡å‡†çš„é‰´å®šè¿‡ç¨‹ã€‚
</code></pre><p>ç»“æœï¼š</p>
<pre><code>$ pamtest test $USER
Trying to authenticate &lt;shanker&gt; for service &lt;test&gt;.
Failure starting pam: system error
</code></pre><p>åœ¨ syslog ä¸­èµ«ç„¶å†™ç€ï¼š</p>
<pre><code>pamtest[72280]: in openpam_read_chain(): /etc/pam.d/test(2): invalid control flag &apos;[default=1]&apos;
</code></pre><p>å””ï¼ŒåŸæ¥ OS X ä¸Šçš„ <code>OpenPAM</code> ä¸æ”¯æŒè¿™ç§è¯­æ³•ã€‚</p>
<p>å’ã€‚ã€‚ã€‚ã€‚ã€‚ï¼ˆæœªå®Œå¾…ç»­ï¼‰</p>
<h3 id="u7ED3_u8BBA"><a href="#u7ED3_u8BBA" class="headerlink" title="ç»“è®º"></a>ç»“è®º</h3><p>äºæ˜¯æˆ‘ä»¬å¾—åˆ°äº†ä¸€ä¸ªåœ¨ OS X ä¸Šèƒ½ç”¨çš„ <code>pam_dotfile</code>ã€‚ä¸‹é¢ç®€å•ä»‹ç»ä¸€ä¸‹è¿™ä¸ªæ¨¡å—çš„å·¥ä½œè¿‡ç¨‹å’Œä½¿ç”¨æ–¹æ³•ã€‚</p>
<p>å½“é’ˆå¯¹æŸä¸ªç”¨æˆ·çš„é‰´å®šå¼€å§‹çš„æ—¶å€™ï¼Œ <code>pam_dotfile</code> ä¼šåœ¨ä¸‹é¢çš„åœ°ç‚¹ä¾æ¬¡å¯»æ‰¾å­˜æ”¾å¯†ç çš„æ•£åˆ—å€¼çš„æ–‡ä»¶ï¼š</p>
<ol>
<li><code>~/.pam-&lt;service&gt;</code></li>
<li><code>~/.pam/&lt;service&gt;</code></li>
<li><code>~/.pam-other</code></li>
<li><code>~/.pam/other</code></li>
</ol>
<p>å…¶ä¸­ï¼Œ<code>&lt;service&gt;</code> ä»£è¡¨è¢«è¯·æ±‚é‰´å®šçš„æœåŠ¡çš„åå­—ï¼Œå¦‚ <code>sshd</code>ã€<code>sudo</code> ç­‰ã€‚å½“å…¶ä¸­æŸä¸ªæ–‡ä»¶çš„æƒé™ä¸æ˜¯ <code>x00</code> æ—¶ï¼Œæˆ–è€…æ˜¯ç¬¦å·é“¾æ¥æ—¶ï¼Œæˆ–è€…çˆ¶ç›®å½•æ˜¯ç»„å¯å†™æˆ–ä»–äººå¯å†™çš„æ—¶å€™ï¼Œè¿™ä¸ªæ–‡ä»¶ä¼šè¢«å¿½ç•¥ã€‚</p>
<p>ç„¶åç”¨æˆ·è¾“å…¥çš„ä½œä¸ºé‰´å®šå‡­æ®çš„å¯†ç å°†ä¼šè¢«æ±‚æ•£åˆ—å€¼ï¼Œä¸ä¹‹å¯¹æ¯”ï¼Œè‹¥æˆåŠŸï¼Œåˆ™é‰´å®šæˆåŠŸï¼›å¦åˆ™é‰´å®šå¤±è´¥ã€‚</p>
<p>é€šè¿‡ <code>pam-dotfile-gen -a &lt;service&gt;</code> æ¥ç”Ÿæˆ <code>~/.pam-&lt;service&gt;</code>ã€‚ä½ éœ€è¦è¾“å…¥ä¸¤éå¯†ç ã€‚</p>
<p>å½“ä¸åŠ å‚æ•°ç›´æ¥è°ƒç”¨ <code>pam-dotfile-gen</code> æ—¶ï¼Œè¯¥ç¨‹åºä»æ ‡å‡†è¾“å…¥è¯»å…¥å¤šç»„æ˜æ–‡å¯†ç ï¼ˆæ¯è¡Œä¸€ä¸ªï¼‰ï¼Œå¹¶ç›¸åº”çš„è¾“å‡ºå®ƒä»¬çš„æ•£åˆ—å€¼ã€‚</p>
<p>æˆ‘åœ¨ä½¿ç”¨è¿™ä¸ªç¨‹åºçš„æ—¶å€™ï¼Œå¾€å¾€æ˜¯å°†ç”Ÿæˆçš„ <code>~/.pam-&lt;service&gt;</code> ç§»åŠ¨åˆ° <code>~/.pam/&lt;service&gt;</code>ï¼Œè¿™æ ·å¯ä»¥è®© <code>home</code> ç›®å½•ä¸‹çš„ dotfiles æ•´é½äº›ã€‚</p>
<h3 id="u540E_u8BB0"><a href="#u540E_u8BB0" class="headerlink" title="åè®°"></a>åè®°</h3><p>æˆ‘æ”¹å¥½çš„ <code>pam_dotfile</code> æ”¾åœ¨äº† <a href="https://github.com/shankerwangmiao/pam_dotfile" target="_blank" rel="external">Github</a> ä¸Šï¼Œæ¬¢è¿æµ‹è¯•ã€‚</p>
<p>å¦å¤–ï¼Œè¿™ä¸ªé¡¹ç›®çš„åœ°å€æ˜¯ <a href="http://0pointer.de/lennart/projects/pam_dotfile/" target="_blank" rel="external">http://0pointer.de/lennart/projects/pam_dotfile/</a>ã€‚ä»åœ°å€ä¸Šæ¥çœ‹ï¼Œ<em>Lennart Poettering</em> è¿™ä¸ªäººåº”è¯¥æè¿‡ä¸€äº›åˆ«çš„é¡¹ç›®ï¼Œå””ï¼Œåº”è¯¥å°±åœ¨ <a href="http://0pointer.de/lennart/projects/" target="_blank" rel="external">http://0pointer.de/lennart/projects/</a>ã€‚çœ‹æ¥è¿˜æ˜¯è¿™ä¸ªäººè¿˜æ˜¯å¾ˆé«˜äº§çš„ä¸€ä¸ªç¨‹åºä½œè€…ã€‚</p>
<p>ä»€ä¹ˆï¼Ÿä½ è¯´ä»€ä¹ˆï¼Ÿä»–è¿˜å†™è¿‡ <code>systemd</code> ï¼Ÿä½ æ²¡å¼€ç©ç¬‘å§ï¼Ÿ</p>
<p>æˆ‘æ“¦ï¼Œè¿™ä¸ª pam æ¨¡å—ç«Ÿç„¶æ˜¯ <code>systemd</code> çš„ä½œè€…çš„ä½œå“ã€‚ã€‚ã€‚orzâ€¦â€¦</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://innull.com/pam_dotfile_repair/" data-id="cimmdamox0003x8z1vuag4nu0" class="article-share-link">Share</a>
      
        <a href="https://innull.com/pam_dotfile_repair/#disqus_thread" class="article-comment-link">ç•™è¨€</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/PAM/">PAM</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/æŠ€æœ¯/">æŠ€æœ¯</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/pam-configuration-how-to/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          PAM é…ç½®ç®€ä»‹
        
      </div>
    </a>
  
  
    <a href="/about-lauguage-program-on-chinese-new-year-gala-2016/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">è¯­è¨€ç´¯çš„è¯­è¨€ç±»ï¼Œæ¬²å“­æ— æ³ª</div>
    </a>
  
</nav>

  
</article>


<section id="comments">
  <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </div>
</section>
</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">æ ‡ç­¾</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/OS-X/">OS X</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PAM/">PAM</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/å®äº‹/">å®äº‹</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/æ„Ÿæƒ³/">æ„Ÿæƒ³</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/æŠ€æœ¯/">æŠ€æœ¯</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/æ”¶è—/">æ”¶è—</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/æ”¿æ²»/">æ”¿æ²»</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/çæ/">çæ</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/çŸ­ç‰‡/">çŸ­ç‰‡</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">æ ‡ç­¾äº‘</h3>
    <div class="widget tagcloud">
      <a href="/tags/OS-X/" style="font-size: 10px;">OS X</a> <a href="/tags/PAM/" style="font-size: 13.33px;">PAM</a> <a href="/tags/å®äº‹/" style="font-size: 10px;">å®äº‹</a> <a href="/tags/æ„Ÿæƒ³/" style="font-size: 13.33px;">æ„Ÿæƒ³</a> <a href="/tags/æŠ€æœ¯/" style="font-size: 16.67px;">æŠ€æœ¯</a> <a href="/tags/æ”¶è—/" style="font-size: 20px;">æ”¶è—</a> <a href="/tags/æ”¿æ²»/" style="font-size: 10px;">æ”¿æ²»</a> <a href="/tags/çæ/" style="font-size: 10px;">çæ</a> <a href="/tags/çŸ­ç‰‡/" style="font-size: 10px;">çŸ­ç‰‡</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">å½’æ¡£</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/04/">å››æœˆ 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/02/">äºŒæœˆ 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/03/">ä¸‰æœˆ 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/09/">ä¹æœˆ 2014</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/08/">å…«æœˆ 2014</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">æœ€æ–°æ–‡ç« </h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/how-to-disable-gui-on-os-x/">å¦‚ä½•ç¦ç”¨ OS X çš„å›¾å½¢ç•Œé¢</a>
          </li>
        
          <li>
            <a href="/pam-configuration-how-to/">PAM é…ç½®ç®€ä»‹</a>
          </li>
        
          <li>
            <a href="/pam_dotfile_repair/">pam_dotfile ä¿®ç†æ‰‹è®°</a>
          </li>
        
          <li>
            <a href="/about-lauguage-program-on-chinese-new-year-gala-2016/">è¯­è¨€ç´¯çš„è¯­è¨€ç±»ï¼Œæ¬²å“­æ— æ³ª</a>
          </li>
        
          <li>
            <a href="/how-to-represent-the-people/">9å¥è¯å†™ç»™ä»£è¡¨å§”å‘˜ï¼šä½ çš„å¤±è¯­ï¼Œ å°±æ„å‘³ç€äººæ°‘çš„æ²‰é»˜</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2016 innull<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    
<script>
  var disqus_shortname = 'innull';
  
  var disqus_url = 'https://innull.com/pam_dotfile_repair/';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">
  <script src="/fancybox/jquery.fancybox.pack.js" type="text/javascript"></script>


<script src="/js/script.js" type="text/javascript"></script>

  </div>
</body>
</html>